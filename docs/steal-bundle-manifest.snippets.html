<!DOCTYPE html>
<!--####################################################################
	THIS IS A GENERATED FILE -- ANY CHANGES MADE WILL BE OVERWRITTEN

	INSTEAD CHANGE:
	source: node_modules/steal-bundle-manifest/docs/html-snippets.md
	@page steal-bundle-manifest.snippets
######################################################################## -->

<!--[if lt IE 7]>
<html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en">
<![endif]-->
<!--[if IE 7]>
<html class="no-js ie lt-ie9 lt-ie8" lang="en">
<![endif]-->
<!--[if IE 8]>
<html class="no-js ie lt-ie9" lang="en">
<![endif]-->
<!--[if IE 9]>
<html class="no-js ie ie9" lang="en">
<![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>StealJS - Generating HTML Snippets </title>
	<meta name="description" content="">
	<meta name="author" content="">
	<meta property="og:title" content="StealJS - Generating HTML Snippets ">
	<meta property="og:description" content="">
	<meta property="og:image" content="https://www.bitovi.com/hs-fs/hubfs/open-source/os-stealjs.png">
	<script type="application/ld+json">
		{
			"@context": "http://www.schema.org",
			"@type": "SoftwareSourceCode",
			"applicationCategory": "DeveloperApplication",
			"brand": "Bitovi",
			"category": "JavaScript Frameworks",
			"codeRepository": "https://github.com/stealjs/steal",
			"description": "",
			"image": "https://www.bitovi.com/hs-fs/hubfs/open-source/os-stealjs.png",
			"license": "https://github.com/stealjs/steal/blob/master/license.md",
			"logo": "https://www.bitovi.com/hs-fs/hubfs/open-source/os-stealjs.png",
			"name": "StealJS - Generating HTML Snippets ",
			"programmingLanguage": "JavaScript"
		}
	</script>
	
		<link rel="stylesheet" type="text/css" href="./static/bundles/bit-docs-site/static.css">
	
	
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-2302003-20', 'auto');
			ga('send', 'pageview');
		</script>
	
	<!--[if lt IE 9]>
		<script type="text/javascript" src="static/html5shiv.js"></script>
	<![endif]-->
</head>

<body class="docs">
	
	<header>
		
		<div style="display: none;" class="navbar"></div>
		<nav class="container">
			<div class="logo-menu">
				<a class="brand" href="./index.html">StealJS</a>

				<ul class="dropdown-menu">
					<li><a href="https://donejs.com/">DoneJS</a></li>
					<li><a href="https://stealjs.com/">StealJS</a></li>
					<li><a href="https://jquerypp.com/">jQuery ++</a></li>
					<li><a href="https://funcunit.com/">FuncUnit</a></li>
					<li><a href="https://documentjs.com/">DocumentJS</a></li>
				</ul>
			</div>

			<ul class="nav">
				<li><a href="https://stealjs.com">Home</a></li>

				
          <li class="active"><a href="index.html">Api</a></li>
        

				<li><a href="https://twitter.com/stealjs">Twitter</a></li>
				<li><a href="https://github.com/stealjs/steal">GitHub</a></li>
				<li><a href="https://gitter.im/stealjs/steal">Chat</a></li>
			</ul>

			<div class="pull-right">
				<div class="bitovi-menu">
					<a href="https://www.bitovi.com" class="bitovi icon-bits">Bitovi</a>
					<ul class="dropdown-menu">
						<li><a href="https://www.bitovi.com">Bitovi.com</a></li>
						<li><a href="https://www.bitovi.com/blog">Blog</a></li>
						<li><a href="https://www.bitovi.com/design">Design</a></li>
						<li><a href="https://www.bitovi.com/development">Development</a></li>
						<li><a href="https://www.bitovi.com/training">Training</a></li>
						<li><a href="https://www.bitovi.com/open-source">Open Source</a></li>
						<li><a href="https://www.bitovi.com/about">About</a></li>
						<li><a href="https://www.bitovi.com/contact">Contact Us</a></li>
					</ul>
				</div>
			</div>
		</nav>
	</header>
	

	
<div class="container api">

	
	<nav class="sidebar">
		
		<ul class="api cascading primary-grouping">
	
		

		
			
				<li class="search-container active">
					<a
						class="sidebar-title"
						href="index.html"
						data-search="StealJS"
					>
						StealJS
					</a>
					
	
		<ul>
			
				
					
						<li class="heading search-container">
							<span>step-by-step guides</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.guides.progressive_loading.html" data-search="Progressive Loading">
							Progressive Loading
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.quick-start.html" data-search="Quick Start">
							Quick Start
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.guides.boolean_conditional_loading.html" data-search="Boolean Conditional Loading">
							Boolean Conditional Loading
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.guides.substitution_conditional_loading.html" data-search="Substitution Conditional Loading">
							Substitution Conditional Loading
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>development</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.development-bundles.html" data-search="Development Bundles">
							Development Bundles
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.using-npm-packages.html" data-search="Using npm Packages">
							Using npm Packages
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.hot-module-replacement.html" data-search="Hot Module Replacement">
							Hot Module Replacement
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.configuration.html" data-search="Configuration">
							Configuration
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.conditionals.html" data-search="Conditional Loading">
							Conditional Loading
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.babel.html" data-search="Babel">
							Babel
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.circular.html" data-search="Circular Dependencies">
							Circular Dependencies
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.error-messages.html" data-search="Error Messages">
							Error Messages
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>bundling</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.optimized-builds.html" data-search="Optimized Builds">
							Optimized Builds
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-tools.code-splitting.html" data-search="Code Splitting">
							Code Splitting
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-tools.tree-shaking.html" data-search="Tree Shaking">
							Tree Shaking
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-tools.watch-mode.html" data-search="Watch Mode">
							Watch Mode
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-tools.multi-main.html" data-search="Multi-main Builds">
							Multi-main Builds
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.project-exporting.html" data-search="Project Exporting">
							Project Exporting
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>production</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.loading-from-cdn.html" data-search="Loading Scripts from a CDN">
							Loading Scripts from a CDN
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.moving-to-prod.html" data-search="Moving to Production">
							Moving to Production
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-bundle-manifest.server.html" data-search="Server templating in Node">
							Server templating in Node
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container active ">
						<a class="page" href="steal-bundle-manifest.snippets.html" data-search="Generating HTML Snippets">
							Generating HTML Snippets
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>advanced</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.writing-plugins.html" data-search="Writing Plugins">
							Writing Plugins
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-tools.guides.streams.html" data-search="Streaming API">
							Streaming API
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>apis</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal.html" data-search="steal">
							steal
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-tools.html" data-search="steal-tools">
							steal-tools
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>migrating</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.migrating.html" data-search="Migrating from Legacy Steal">
							Migrating from Legacy Steal
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.topics.migrating-one.html" data-search="Migrating to StealJS 1.x">
							Migrating to StealJS 1.x
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.topics.migrating-two.html" data-search="Migrating to StealJS 2.x">
							Migrating to StealJS 2.x
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>about</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="page" href="StealJS.why.html" data-search="Why StealJS">
							Why StealJS
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="guides.Contributing.html" data-search="Contributing">
							Contributing
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
				
					
						<li class="heading search-container">
							<span>ecosystem</span>
							
	
		<ul>
			
				
					
					
					<li class="search-container">
						<a class="module" href="grunt-steal.html" data-search="grunt-steal">
							grunt-steal
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="page" href="steal-bundle-manifest.html" data-search="steal-bundle-manifest">
							steal-bundle-manifest
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="module" href="steal-conditional.html" data-search="steal-conditional">
							steal-conditional
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="module" href="steal-css.html" data-search="steal-css">
							steal-css
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="module" href="steal-less.html" data-search="steal-less">
							steal-less
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="module" href="steal-mocha.html" data-search="steal-mocha">
							steal-mocha
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="module" href="steal-qunit.html" data-search="steal-qunit">
							steal-qunit
						</a>
					</li>
					

				
			
				
					
					
					<li class="search-container">
						<a class="module" href="steal-socket.io.html" data-search="steal-socket.io">
							steal-socket.io
						</a>
					</li>
					

				
			
		</ul>
	


						</li>
					
					

				
			
		</ul>
	


				</li>
			
		
	
</ul>

	</nav>
	

	
	<article class="content docs">
	

		
		<section class="title">
			<div class="heading">
<h1>Generating HTML Snippets</h1>
	<ul class="tags">
		<li>page</li>
	</ul>
	
	
</div>

<div class="sub-heading">
	
	
		<span class="module">steal-bundle-manifest.snippets</span>
	
	
	
	<span class="inherits">&nbsp;</span>
</div>

<ul class="links">
	
	
	
</ul>
<br />

		</section>
		

		
		<section class="contents">
			<div class="on-this-page-container"></div>
		</section>
		

		

		
		<section class="description">
			<!--
-->

		</section>
		

		
			
		

		


		
		<section class="comment">
			<p>When using <a href="https://stealjs.com/docs/steal-tools.optimize.html">optimized builds</a> with <a href="https://github.com/stealjs/steal-tools">steal-tools</a>, separate bundles are created which are able to be loaded in parallel via <code>async</code> script tags like so:</p>
<pre><code class="language-html">&lt;script src=&quot;/dist/bundles/app/app.js&quot; async&gt;&lt;/script&gt;
&lt;script src=&quot;/dist/bundles/app/page-one.js&quot; async&gt;&lt;/script&gt;
</code></pre>
<p>Given that steal-tools intelligently splits bundles to optimize for page load times, you don't necessary <em>know</em> which bundles are going to be created. You might have a new bundle be created, for example, when you add a new dependency to your project.</p>
<p>This is where the <strong>bundle manifest</strong> file comes into play. It creates a file that can be used to know, for a given entry module, what bundles (JavaScript and CSS) need to be loaded.</p>
<p>In this guide we'll take an existing build script and update it to generate snippets of HTML, that you can use from your server-side templating engine.</p>
<h2>Creating the bundle manifest</h2>
<p>If you've checked out the <a href="https://stealjs.com/docs/StealJS.guides.progressive_loading.html">progressive loading guide</a> then you have probably seen (or built) the <a href="https://github.com/stealjs/myhub">myhub</a> app. We're going to use this app as the example, but you can use your existing StealJS app as well.</p>
<p>If you'd like to follow along, start by cloning the myhub app from GitHub:</p>
<pre><code>git clone git@github.com:stealjs/myhub.git
</code></pre>
<p>Then change the <strong>build.js</strong> file (if using your own app you likely have a similar file, and if not you can create one). It currently looks like:</p>
<pre><code class="language-js">var stealTools = require(&quot;steal-tools&quot;);

stealTools.build({}, {
  bundleSteal: true
});
</code></pre>
<p>Change it to look like this instead:</p>
<pre><code class="language-js">var stealTools = require(&quot;steal-tools&quot;);

stealTools.optimize({}, {
  bundleManifest: true
});
</code></pre>
<p>Note here:</p>
<ol>
<li>This uses the <code>stealTools.optimize</code> function rather than <code>stealTools.build</code>. This build is needed in order to use the async script tags described before.</li>
<li>The <code>bundleManifest: true</code> option is used to generate the bundle manifest file that is used by <a href="https://stealjs.com/docs/steal-bundle-manifest.html">steal-bundle-manifest</a>.</li>
</ol>
<h2>Generating snippets</h2>
<p>The goal here is to create snippets of HTML that we can save to a folder and then use in our backend application server. To do this we will use <a href="https://github.com/stealjs/steal-bundle-manifest">steal-bundle-manifest</a>.</p>
<p>We'll create these snippets in a subfolder of the generate <code>dist/</code> folder, <code>dist/snippets</code>. First let's install a couple of utilities we need:</p>
<pre><code class="language-shell">npm install steal-bundle-manifest make-dir --save
</code></pre>
<p>In addition to steal-bundle-manifest, we are also installing <a href="https://www.npmjs.com/package/make-dir">make-dir</a>, a library to let us recursively create directories.</p>
<p>Create a new file <strong>generate-snippets.js</strong> and paste this code:</p>
<pre><code class="language-js">var BundleManifest = require(&quot;steal-bundle-manifest&quot;);
var bundles = require(&quot;./package.json&quot;).steal.bundle;
var fs = require(&quot;fs&quot;);

module.exports = function(){
  var manifest = new BundleManifest();

  bundles.forEach(bundleName =&gt; {
    var bundle = manifest.for(bundleName);
    var prefix = bundleName.split('/').pop();
    var fnprefix = `dist/snippets/${prefix}`;

    var styles = bundle.assets.filter(a =&gt; a.type === 'style');
    var stylesHTML = bundle.toHTML(styles);
    fs.writeFile(`${fnprefix}-styles.html`, stylesHTML, () =&gt; {});

    var scripts = bundle.assets.filter(a =&gt; a.type === 'script');
    var scriptsHTML = bundle.toHTML(scripts);
    fs.writeFile(`${fnprefix}-scripts.html`, scriptsHTML, () =&gt; {});
  });
};
</code></pre>
<p>And update your <strong>build.js</strong> script to use it:</p>
<pre><code class="language-js">var stealTools = require(&quot;steal-tools&quot;);
var makeDir = require(&quot;make-dir&quot;);
var generateSnippets = require(&quot;./generate-snippets&quot;);

stealTools.optimize({}, {
  bundleManifest: true
})
.then(() =&gt; makeDir(&quot;dist/snippets&quot;))
.then(generateSnippets);
</code></pre>
<p>What this does is:</p>
<ol>
<li>Reads the <code>steal.bundle</code> property from your package.json to determine which bundles should have HTML snippets created for.</li>
<li>Creates a build that includes the bundle manifest.</li>
<li>Uses steal-bundle-manifest to create HTML snippets for <em>styles</em> and <em>scripts</em>, and saves them as <code>dist/snippets/page-scripts.html</code> and <code>dist/snippets/page-styles.html</code>.</li>
</ol>
<p>You can run this script with:</p>
<pre><code>node build.js
</code></pre>
<p>Which should give you a <code>dist/snippets</code> folder that looks like:</p>
<p><img width="619" alt="snippets-folder" style="background-color:transparent;border:none;" src="https://user-images.githubusercontent.com/361671/29893772-2c059df0-8da1-11e7-9f7e-6a6c73065a9e.png"></p>
<h2>Add snippets to your route views</h2>
<p>This part differs depending on which application framework you are using.  Whether you are using Ruby on Rails or Java or something else, it's best to refer to your framework's documentation on how to use HTML snippets in your templates.</p>
<p>This example shows use in PHP, using the include statement.</p>
<pre><code class="language-php">&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;title&gt;&lt;/title&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;

    &lt;?php include('dist/snippets/puppies-styles.html'); ?&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class=&quot;container&quot;&gt;Hello World.&lt;/div&gt;

    &lt;?php include('dist/snippets/puppies-scripts.html'); ?&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>And that's it! Now every time you run your build you will also generate these snippets of HTML, so that every JavaScript bundle can load in parallel.</p>

		</section>
		
		

		

		

	
	</article>
	


</div>


<survey-ad>
  <button aria-label="Close" class="close" type="button">
    <span aria-hidden="true">&times;</span>
  </button>
  <a href="https://donejs.com/survey.html" target="_blank">
    Help us improve StealJS by taking our community survey
  </a>
</survey-ad>


	
	<footer>
		<nav class="container">
			<a class="brand javascriptmvc" href="index.html"></a>
		</nav>
	</footer>
	

	<script type="text/javascript">
		var docObject = {"src":{"path":"node_modules/steal-bundle-manifest/docs/html-snippets.md"},"description":"<!--\n-->\n","name":"steal-bundle-manifest.snippets","title":"Generating HTML Snippets","type":"page","parent":"StealJS.production","pathToRoot":".."};
	</script>

	
		<script>
		  steal = {
		    instantiated: {
		      "bundles/bit-docs-site/static.css!$css" : null
		    }
		  }
		</script>
		<script type='text/javascript'
				data-main="bit-docs-site/static"
				src="./static/node_modules/steal/steal.production.js"></script>
	
</body>

</html>
